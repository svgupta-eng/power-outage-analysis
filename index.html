<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Outage Project</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 40px auto;
            padding: 0 20px;
            color: #333;
        }

        /* MAIN TITLE */
        .main-header {
            text-align: center;
            margin-bottom: 60px;
            border-bottom: 2px solid #eee;
            padding-bottom: 20px;
        }
        .main-header h1 {
            font-size: 36px;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        .creators {
            font-size: 18px;
            color: #666;
            font-style: italic;
        }

        /* SECTION HEADERS */
        h2 {
            font-size: 24px;
            color: #2c3e50;
            margin-top: 40px;
            border-left: 5px solid #3498db;
            padding-left: 15px;
        }

        h3 {
            font-size: 20px;
            color: #2c3e50;
            margin-top: 30px;
        }

        code {
            background-color: #f4f4f4;
            padding: 2px 5px;
            border-radius: 4px;
            font-family: monospace;
        }

        /* TABLE STYLES */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            white-space: nowrap;
        }
        th {
            background-color: #f4f4f4;
            color: #2c3e50;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .table-container {
            overflow-x: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }
        
        /* IFRAME STYLE */
        iframe {
            border: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border-radius: 8px;
            margin-top: 20px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <div class="main-header">
        <h1>Power Outage Analysis</h1>
        <p class="creators">By Sana Gupta & Aarushi Jain</p> 
    </div>

    <h2>Introduction</h2>
    <p>
    Our dataset contains detailed information on power outages across different U.S. states, with each row 
    representing a single outage event. These events include when the outage began, how long it lasted, how many 
    customers were affected, and what factors contributed to the disruption. Understanding this dataset is important 
    because power outages are becoming increasingly common due to aging infrastructure, extreme weather, and rising 
    energy demands. By examining outage patterns, we can better understand which factors contribute most to 
    disruptions and potentially identify ways to reduce their impact on communities.
    </p>

    <p>
    The central question guiding this project is: <strong>Which factors are most strongly associated with longer 
    power outage durations?</strong> This question matters because outage duration directly affects public safety, 
    economic loss, and community resilience. If we can understand what drives long outages, decision-makers can 
    better prepare and respond to emergencies.
    </p>

    <p>The dataset contains <strong>1534 rows</strong>. The relevant columns for this question are:</p>

    <ul>
        <li><strong>OUTAGE.START</strong> — The start date and time of the outage event.</li>
        <li><strong>OUTAGE.DURATION</strong> — The length of the outage in minutes.</li>
        <li><strong>CUSTOMERS.AFFECTED</strong> — Estimated number of customers impacted.</li>
        <li><strong>CAUSE.CATEGORY</strong> — High-level category describing the primary cause of the outage.</li>
        <li><strong>CAUSE.SUBCATEGORY</strong> — More specific details about the cause.</li>
        <li><strong>CLIMATE.REGION</strong> — The assigned climate region for the state in which the outage occurred.</li>
    </ul>

    <p>
    These initial observations help motivate deeper analysis into which factors are truly connected to longer 
    outage durations.
    </p>


    <h2>Data Cleaning and Exploratory Data Analysis</h2>
    <p>
    Before analyzing the dataset, several cleaning steps were necessary to ensure accuracy and consistency. First, 
    rows containing header information and unrelated metadata were removed so the dataset included only valid 
    outage records. Placeholder values such as <code>--</code>, <code>Unknown</code>, and <code>N/A</code> were replaced with proper 
    missing values to prevent incorrect interpretation during analysis. Numeric columns such as <code>YEAR</code>, 
    <code>MONTH</code>, <code>POPULATION</code>, and <code>OUTAGE.DURATION</code> were converted to numeric types, with invalid values coerced 
    to missing where appropriate.
    </p>

    <p>
    Next, the outage start date and time were combined into a single <code>OUTAGE.START</code> column to reflect the full 
    timestamp of each event. Redundant columns such as <code>OUTAGE.START.DATE</code> and <code>OUTAGE.START.TIME</code> were then 
    removed. Additionally, an <code>URBANIZATION</code> variable was created by combining <code>POPPCT_URBAN</code> and 
    <code>POPPCT_UC</code> to give a more comprehensive understanding of the urban population share in each state.
    </p>

    <h3>Cleaned Data Head</h3>
    <p>Below is the first few rows of our cleaned DataFrame:</p>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>YEAR</th>
                    <th>MONTH</th>
                    <th>U.S._STATE</th>
                    <th>NERC.REGION</th>
                    <th>CLIMATE.REGION</th>
                    <th>ANOMALY.LEVEL</th>
                    <th>CLIMATE.CATEGORY</th>
                    <th>OUTAGE.DURATION</th>
                    <th>HURRICANE.NAMES</th>
                    <th>POPULATION</th>
                    <th>CAUSE.CATEGORY</th>
                    <th>OUTAGE.START</th>
                    <th>URBANIZATION</th>
                    <th>duration_missing</th>
                    <th>cause_missing</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>2011</td>
                    <td>7.0</td>
                    <td>Minnesota</td>
                    <td>MRO</td>
                    <td>East North Central</td>
                    <td>-0.3</td>
                    <td>normal</td>
                    <td>3060.0</td>
                    <td>NaN</td>
                    <td>5348119</td>
                    <td>severe weather</td>
                    <td>2011-07-01 17:00:00</td>
                    <td>88.55</td>
                    <td>0</td>
                    <td>0</td>
                </tr>
                <tr>
                    <td>2014</td>
                    <td>5.0</td>
                    <td>Minnesota</td>
                    <td>MRO</td>
                    <td>East North Central</td>
                    <td>-0.1</td>
                    <td>normal</td>
                    <td>1.0</td>
                    <td>NaN</td>
                    <td>5457125</td>
                    <td>intentional attack</td>
                    <td>2014-05-11 18:38:00</td>
                    <td>88.55</td>
                    <td>0</td>
                    <td>0</td>
                </tr>
                <tr>
                    <td>2010</td>
                    <td>10.0</td>
                    <td>Minnesota</td>
                    <td>MRO</td>
                    <td>East North Central</td>
                    <td>-1.5</td>
                    <td>cold</td>
                    <td>3000.0</td>
                    <td>NaN</td>
                    <td>5310903</td>
                    <td>severe weather</td>
                    <td>2010-10-26 20:00:00</td>
                    <td>88.55</td>
                    <td>0</td>
                    <td>0</td>
                </tr>
                <tr>
                    <td>2012</td>
                    <td>6.0</td>
                    <td>Minnesota</td>
                    <td>MRO</td>
                    <td>East North Central</td>
                    <td>-0.1</td>
                    <td>normal</td>
                    <td>2550.0</td>
                    <td>NaN</td>
                    <td>5380443</td>
                    <td>severe weather</td>
                    <td>2012-06-19 04:30:00</td>
                    <td>88.55</td>
                    <td>0</td>
                    <td>0</td>
                </tr>
                <tr>
                    <td>2015</td>
                    <td>7.0</td>
                    <td>Minnesota</td>
                    <td>MRO</td>
                    <td>East North Central</td>
                    <td>1.2</td>
                    <td>warm</td>
                    <td>1740.0</td>
                    <td>NaN</td>
                    <td>5489594</td>
                    <td>severe weather</td>
                    <td>2015-07-18 02:00:00</td>
                    <td>88.55</td>
                    <td>0</td>
                    <td>0</td>
                </tr>
            </tbody>
        </table>
    </div>

    <p>
    These data cleaning steps ensured the dataset was well-structured and ready for exploratory analysis. Below, we 
    present both univariate and bivariate visualizations, as well as grouped summaries, to explore how various 
    factors relate to outage duration and outage characteristics across states and causes.
    </p>

    <h3>Univariate Analysis</h3>
    <iframe src="assets/outages_by_month.html" width="100%" height="600" frameborder="0"></iframe>
    <p>
    This bar chart shows how outages are distributed across the year, with clear peaks in summer months like June and July, when heat and higher energy demand put extra stress on the grid.
    </p>

    <h3>Bivariate Analysis</h3>
    <iframe src="assets/outages_by_climate_region.html" width="100%" height="600" frameborder="0"></iframe>
    <p>
    This plot compares outage frequency across climate regions and shows that the Northeast and some southern and western regions experience more outages, reflecting differences in weather patterns and infrastructure.
    </p>

    <h3>Interesting Aggregates</h3>
    <p>The table below shows the average outage duration (in minutes) for different cause categories.</p>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>CAUSE.CATEGORY</th>
                    <th>Mean Outage Duration (Minutes)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>equipment failure</td>
                    <td>1816.91</td>
                </tr>
                <tr>
                    <td>fuel supply emergency</td>
                    <td>13484.03</td>
                </tr>
                <tr>
                    <td>intentional attack</td>
                    <td>429.98</td>
                </tr>
                <tr>
                    <td>islanding</td>
                    <td>200.55</td>
                </tr>
                <tr>
                    <td>public appeal</td>
                    <td>1468.45</td>
                </tr>
                <tr>
                    <td>severe weather</td>
                    <td>3883.99</td>
                </tr>
                <tr>
                    <td>system operability disruption</td>
                    <td>728.87</td>
                </tr>
            </tbody>
        </table>
    </div>

    <h2>Assessment of Missingness</h2>
    <p>
    We believe that the <strong>CUSTOMERS.AFFECTED</strong> column is likely <strong>NMAR</strong> (Not Missing At Random). 
    </p>

    <p>
    <strong>Reasoning:</strong> The missingness in this column is likely dependent on the missing value itself. 
    Utility companies and federal agencies are more rigorous about recording data for massive, high-impact events. 
    If an outage affects a very small number of people, it may not trigger the reporting threshold required by 
    department of energy guidelines, or the utility might simply prioritize restoring power over precise clerical documentation 
    for minor events. Therefore, the probability of the value being missing increases as the actual number of customers affected decreases. 
    Because the missingness depends on the value of the data we typically cannot see, this falls under NMAR.
    </p>

    <p>
    <strong>Additional Data:</strong> To transform this from NMAR to MAR (Missing At Random), we would want to obtain 
    data regarding the <strong>reporting policies and minimum thresholds</strong> of the specific utility companies involved. 
    If we had a dataset showing that "Utility Company X only reports outages affecting >500 customers," we could explain 
    the missingness using that observed variable.
    </p>

    <h3>Missingness Plot</h3>
    <p>The plot below visualizes the distribution of missing values in our dataset.</p>
    <iframe src="assets/missingness_plot.html" width="100%" height="600" frameborder="0"></iframe>

    <h3>Missingness Dependency Analysis</h3>
    <p>
    We analyzed whether the missingness of <code>CUSTOMERS.AFFECTED</code> depends on other columns.
    Using permutation tests with the difference in mean outage duration as our test statistic, we found:
    </p>
    <ul>
      <li>
        <strong>Depends on:</strong> <code>OUTAGE.DURATION</code> (p-value &lt; 0.05).
        This suggests that records with missing customer counts tend to have systematically different
        outage durations, supporting our NMAR reasoning.
      </li>
      <li>
        <strong>Does not depend on:</strong> <code>YEAR</code> (p-value &gt; 0.05).
        This suggests that missingness is not strongly tied to the calendar year.
      </li>
    </ul>
    <p>
    Overall